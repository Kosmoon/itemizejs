"use strict";function _instanceof(e,t){if(t!=null&&typeof Symbol!=="undefined"&&t[Symbol.hasInstance]){return t[Symbol.hasInstance](e)}else{return e instanceof t}}function _classCallCheck(e,t){if(!_instanceof(e,t)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||false;o.configurable=true;if("value"in o)o.writable=true;Object.defineProperty(e,o.key,o)}}function _createClass(e,t,i){if(t)_defineProperties(e.prototype,t);if(i)_defineProperties(e,i);return e}var Itemize=function(){function i(e){_classCallCheck(this,i);this.items=[];this.globalOptions=this.mergeOptions(e);var t=this.optionsTypeCheck(this.globalOptions);if(t!=="valid"){console.error("- Itemize - TYPE ERROR:\n"+t)}else{this.targetElements=this.getTargetElements();if(this.targetElements&&this.targetElements.length>0){this.itemizeIt()}else{console.error("- Itemize - ERROR:\n Cannot find any DOM elements with the attribute 'itemize' \n")}}this.elPos={}}_createClass(i,[{key:"getTargetElements",value:function e(){try{return document.querySelectorAll("[itemize]")}catch(e){console.error(e);return null}}},{key:"getOptionsFromAttributes",value:function t(e,t){if(e.getAttribute("eraseBtn")==="false"){t.eraseBtn=false}else if(e.getAttribute("eraseBtn")==="true"){t.eraseBtn=true}if(e.getAttribute("modalConfirm")==="false"){t.modalConfirm=false}else if(e.getAttribute("modalConfirm")==="true"){t.modalConfirm=true}if(e.getAttribute("flipAnimation")==="false"){t.flipAnimation=false}else if(e.getAttribute("flipAnimation")==="true"){t.flipAnimation=true}if(typeof e.getAttribute("eraseBtnWidth")==="string"&&parseInt(e.getAttribute("eraseBtnWidth"))>0){t.eraseBtnWidth=parseInt(e.getAttribute("eraseBtnWidth"))}if(typeof e.getAttribute("customModalText")==="string"){t.customModalText=e.getAttribute("customModalText")}if(typeof e.getAttribute("flipAnimDuration")==="string"&&parseInt(e.getAttribute("flipAnimDuration"))>0){t.flipAnimDuration=parseInt(e.getAttribute("flipAnimDuration"))}return t}},{key:"itemizeIt",value:function o(){var u=this;var p="";try{var e=function e(e){var n=u.targetElements[e];var t=u.makeId(8);n.itemizeId=t;n.classList.add("itemize_parent_".concat(t));for(var i=n.classList.length-1;i>=0;i--){if(n.classList[i].indexOf("itemize_parent")!==-1){n.classList.remove(n.classList[i])}}n.classList.add("itemize_parent_".concat(t));var o=Object.assign({},u.globalOptions);o=u.getOptionsFromAttributes(n,o);n.options=o;var r={attributes:true,childList:true,subtree:true};var a=function a(e,t){var i=true;var o=false;var n=undefined;try{for(var r=e[Symbol.iterator](),a;!(i=(a=r.next()).done);i=true){var s=a.value;if(s.type=="childList"){s.addedNodes.forEach(function(e){var t=true;e.classList.forEach(function(e){if(e.indexOf("itemize_")!==-1){t=false}});if(t){console.log("nouvel element added");console.log(e)}});s.removedNodes.forEach(function(e){var t=true;e.classList.forEach(function(e){if(e.indexOf("itemize_")!==-1){t=false}});if(t){console.log("nouvel element removed");console.log(e)}})}}}catch(l){o=true;n=l}finally{try{if(!i&&r["return"]!=null){r["return"]()}}finally{if(o){throw n}}}};var s=new MutationObserver(a);s.observe(n,r);var l=document.querySelector(u.target+" .itemize_style");if(l){n.querySelector(".itemize_style").remove()}var m=document.createElement("style");m.classList.add("itemize_style");m.type="text/css";var c="";if(n.options.eraseBtn&&!n.options.eraseBtnClass){c+=".itemize_parent_".concat(n.itemizeId," .itemize_btn_close{position:absolute;top:0!important;right:0!important;width:").concat(n.options.eraseBtnWidth,"px!important;height:").concat(n.options.eraseBtnWidth,"px!important;overflow:hidden;cursor:pointer;margin-top:5px;margin-right:5px}.itemize_parent_").concat(n.itemizeId," .itemize_btn_close:hover::after,.itemize_parent_").concat(n.itemizeId," .itemize_btn_close:hover::before{background:").concat(n.options.eraseBtnHoverColor,"}.itemize_parent_").concat(n.itemizeId," .itemize_btn_close::after,.itemize_parent_").concat(n.itemizeId," .itemize_btn_close::before{content:'';position:absolute;height:").concat(n.options.eraseBtnThickness,"px;width:").concat(n.options.eraseBtnWidth,"px;top:50%;left:0;margin-top:").concat(n.options.eraseBtnThickness*.5<1?-1:-n.options.eraseBtnThickness*.5,"px;background:").concat(n.options.eraseBtnColor,";border-radius:100%}.itemize_parent_").concat(n.itemizeId," .itemize_btn_close::before{-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}.itemize_parent_").concat(n.itemizeId," .itemize_btn_close::after{-webkit-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-ms-transform:rotate(-45deg);-o-transform:rotate(-45deg);transform:rotate(-45deg)}")}if(m.styleSheet){m.styleSheet.cssText=c}else{m.appendChild(document.createTextNode(c))}n.appendChild(m);var f=function f(e){var t=n.children[e];if(t.type!=="text/css"&&typeof t.getAttribute("notItemize")!=="string"){if(!t.itemizeId){t.itemizeId=u.makeId(8)}u.items.push(t);t.classList.add("itemize_item_"+t.itemizeId);if(!n.options.eraseBtn){t.onclick=function(){if(n.options.modalConfirm){u.modalConfirm(t.itemizeId)}else{u.erase(t.itemizeId)}}}else{if(!n.options.eraseBtnClass){t.style.position="relative";var i=document.createElement("div");i.classList.add("itemize_btn_"+t.itemizeId);i.classList.add("itemize_btn_close");i.onclick=function(){if(n.options.modalConfirm){console.log(t.itemizeId);u.modalConfirm(t.itemizeId)}else{u.erase(t.itemizeId)}};t.appendChild(i)}else{var o=document.querySelector(".itemize_item_"+t.itemizeId+" ."+n.options.eraseBtnClass);if(!o){p+="Cannot find specified class: "+n.options.eraseBtnClass+"\n"}o.onclick=function(){if(n.options.modalConfirm){u.modalConfirm(t.itemizeId)}else{u.erase(t.itemizeId)}}}}}};for(var d=0;d<n.children.length;d++){f(d)}};for(var t=0;t<this.targetElements.length;t++){e(t)}}catch(i){console.error("- Itemize - ERROR:\n"+p);console.error(i)}}},{key:"modalConfirm",value:function n(e){var t=this;try{var i=null;if(typeof e==="string"){for(var o=0;o<this.items.length;o++){if(this.items[o].itemizeId===e){i=this.items[o]}}if(!i){i=document.querySelector(e);if(!i||!i.itemizeId){throw new Error("Not a valid Itemize element1, cannot create a confirm modal.")}}if(!i){throw new Error("No item found2, cannot create a confirm modal.")}}else{i=elem;if(!i){throw new Error("No item found3, cannot create a confirm modal.")}if(!i.itemizeId){throw new Error("Not a valid Itemize element4, cannot create a confirm modal.")}}var n=document.createElement("div");var r=document.createElement("div");var a=document.createElement("div");var s=document.createElement("div");var l=document.createElement("button");var m=document.createElement("button");var c=document.querySelector("body");var f=c.style.overflow;c.style.overflow="hidden";n.classList.add("itemize_modal_backdrop");r.classList.add("itemize_modal");a.classList.add("itemize_modal_text");l.classList.add("itemize_modal_btnConfirm");m.classList.add("itemize_modal_btnCancel");a.textContent=i.parentNode.options.customModalText;l.innerHTML="Yes";m.innerHTML="Cancel";s.appendChild(m);s.appendChild(l);r.appendChild(a);r.appendChild(s);n.onclick=function(){c.removeChild(n);c.removeChild(r);c.style.overflow=f};m.onclick=function(){c.removeChild(n);c.removeChild(r);c.style.overflow=f};l.onclick=function(){t.erase(e);c.removeChild(n);c.removeChild(r);c.style.overflow=f};Object.assign(r.style,{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"25px",background:"#FFFFFF",width:"90vw",maxWidth:"500px",borderRadius:"4px",boxSizing:"border-box",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center",fontFamily:"helvetica",zIndex:1e6});Object.assign(a.style,{marginBottom:"25px"});Object.assign(s.style,{width:"100%",display:"flex"});Object.assign(m.style,{background:"#6C757D",border:"none",padding:"10px 0 10px 0",borderTopLeftRadius:"4px",borderBottomLeftRadius:"4px",flex:"1 0 auto",cursor:"pointer",color:"#FFFFFF"});Object.assign(l.style,{background:"#F94336",border:"none",padding:"10px 0 10px 0",borderTopRightRadius:"4px",borderBottomRightRadius:"4px",flex:"1 0 auto",cursor:"pointer",color:"#FFFFFF"});Object.assign(n.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0, 0, 0,0.5)",zIndex:1e5});c.prepend(r);c.prepend(n);n.animate([{opacity:0},{opacity:1}],{duration:300,easing:"ease-in-out",fill:"both"});r.animate([{opacity:0},{opacity:1}],{duration:300,easing:"ease-in-out",fill:"both"})}catch(d){console.error("- Itemize - ERROR:\n"+d)}}},{key:"erase",value:function r(e){var t=this;try{var i=null;if(typeof e==="string"){for(var o=0;o<this.items.length;o++){if(this.items[o].itemizeId===e){i=this.items[o];i.arrayPosition=o}}if(!i){i=document.querySelector(e);if(!i||!i.itemizeId){throw new Error("Not a valid Itemize element")}for(var n=0;n<this.items.length;n++){if(this.items[n].itemizeId===i.itemizeId){i.arrayPosition=n}}}if(!i){throw new Error("No item found to erase")}}else{i=e;if(!i){throw new Error("No item found to erase")}if(!i.itemizeId){throw new Error("Not a valid Itemize element")}for(var r=0;r<this.items.length;r++){if(i.itemizeId===this.items[r].itemizeId){i.arrayPosition=r}}}if(i.arrayPosition||i.arrayPosition===0){if(!i.removeStatus||i.removeStatus!=="pending"){if(this.globalOptions.beforeErase){i.removeStatus="pending";var a=this.globalOptions.beforeErase(i);if(typeof a.then==="function"){a.then(function(e){console.log(e);if(i.parentNode.options.flipAnimation){t.flipRead(t.items);t.flipRemove(i);t.items.splice(i.arrayPosition,1);t.flipPlay(t.items)}else{i.parentNode.removeChild(i);t.items.splice(i.arrayPosition,1)}i.removeStatus=null})["catch"](function(e){console.log(e);i.removeStatus=null})}else if(a){if(i.parentNode.options.flipAnimation){this.flipRead(this.items);this.flipRemove(i);this.items.splice(i.arrayPosition,1);this.flipPlay(this.items)}else{i.parentNode.removeChild(i);this.items.splice(i.arrayPosition,1)}i.removeStatus=null}}else{if(i.parentNode.options.flipAnimation){this.flipRead(this.items);this.flipRemove(i);this.items.splice(i.arrayPosition,1);this.flipPlay(this.items)}else{i.parentNode.removeChild(i);this.items.splice(i.arrayPosition,1)}i.removeStatus=null}}}else{throw new Error("this element has an invalid itemizeId")}}catch(s){console.error("- Itemize - ERROR:\n"+s)}}},{key:"flipRemove",value:function a(e){e.parentNode.appendChild(e);var t=e.getBoundingClientRect();var i=this.elPos[e.itemizeId];var o=i.x-t.x;var n=i.y-t.y;e.animate([{transform:"translate(".concat(o,"px, ").concat(n,"px)"),opacity:1},{transform:"translate(".concat(o+50,"px, ").concat(n,"px)"),opacity:0}],{duration:e.parentNode.options.flipAnimDuration,easing:"ease-in-out",fill:"both"});setTimeout(function(){e.parentNode.removeChild(e)},e.parentNode.options.flipAnimDuration)}},{key:"flipRead",value:function s(e){this.elPos={};for(var t=0;t<e.length;t++){this.elPos[e[t].itemizeId]=e[t].getBoundingClientRect()}}},{key:"flipPlay",value:function l(e){for(var t=0;t<e.length;t++){var i=e[t].getBoundingClientRect();var o=this.elPos[e[t].itemizeId];var n=o.x-i.x;var r=o.y-i.y;var a=o.width/i.width;var s=o.height/i.height;e[t].animate([{transform:"translate(".concat(n,"px, ").concat(r,"px) scale(").concat(a,", ").concat(s,")")},{transform:"none"}],{duration:e[t].parentNode.options.flipAnimDuration,easing:"ease-in-out",fill:"both"})}}},{key:"mergeOptions",value:function m(e){try{var t={eraseBtn:true,eraseBtnWidth:20,eraseBtnThickness:2,eraseBtnColor:"#525252",eraseBtnHoverColor:"#000000",eraseBtnClass:null,modalConfirm:false,customModalText:"Are you sure to remove this item?",flipAnimation:true,flipAnimDuration:500,beforeErase:null};for(var i in e){if(e.hasOwnProperty(i))t[i]=e[i]}return t}catch(o){console.error(o)}}},{key:"optionsTypeCheck",value:function c(e){var t="";if(typeof e.eraseBtn!=="boolean"){t+="option 'button' must be a Boolean\n"}if(typeof e.modalConfirm!=="boolean"){t+="option 'modalConfirm' must be a Boolean\n"}if(typeof e.eraseBtnWidth!=="number"){t+="option 'eraseBtnWidth' must be a Number\n"}if(typeof e.eraseBtnThickness!=="number"){t+="option 'eraseBtnThickness' must be a Number\n"}if(e.eraseBtnClass&&typeof e.eraseBtnClass!=="string"){t+="option 'buttonClass' must be a String\n"}if(typeof e.customModalText!=="string"){t+="option 'customModalText' must be a String\n"}if(typeof e.flipAnimation!=="boolean"){t+="option 'flipAnimation' must be a Boolean\n"}if(typeof e.flipAnimDuration!=="number"){t+="option 'flipAnimDuration' must be a Number\n"}if(e.beforeErase&&typeof e.beforeErase!=="function"){t+="option 'beforeErase' must be a Function\n"}if(t===""){return"valid"}else{return t}}},{key:"makeId",value:function f(e){var t="";var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";var o=i.length;for(var n=0;n<e;n++){t+=i.charAt(Math.floor(Math.random()*o))}return t}}]);return i}();