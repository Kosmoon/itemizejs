"use strict";function _instanceof(e,t){if(t!=null&&typeof Symbol!=="undefined"&&t[Symbol.hasInstance]){return t[Symbol.hasInstance](e)}else{return e instanceof t}}function _classCallCheck(e,t){if(!_instanceof(e,t)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||false;o.configurable=true;if("value"in o)o.writable=true;Object.defineProperty(e,o.key,o)}}function _createClass(e,t,i){if(t)_defineProperties(e.prototype,t);if(i)_defineProperties(e,i);return e}var Itemize=function(){function i(e){_classCallCheck(this,i);this.items=[];this.globalOptions=this.mergeOptions(e);this.alertNb=0;var t=this.optionsTypeCheck(this.globalOptions);if(t!=="valid"){console.error("- Itemize - TYPE ERROR:\n"+t)}else{this.targetElements=this.getTargetElements();if(this.targetElements&&this.targetElements.length>0){this.itemizeIt()}else{console.error("- Itemize - ERROR:\n Cannot find any DOM elements with the attribute 'itemize' \n")}}this.elPos={}}_createClass(i,[{key:"getTargetElements",value:function e(){try{return document.querySelectorAll("[itemize]")}catch(e){console.error(e);return null}}},{key:"getOptionsFromAttributes",value:function t(e,t){if(e.getAttribute("eraseBtn")==="false"){t.eraseBtn=false}else if(e.getAttribute("eraseBtn")==="true"){t.eraseBtn=true}if(e.getAttribute("modalConfirm")==="false"){t.modalConfirm=false}else if(e.getAttribute("modalConfirm")==="true"){t.modalConfirm=true}if(e.getAttribute("flipAnimation")==="false"){t.flipAnimation=false}else if(e.getAttribute("flipAnimation")==="true"){t.flipAnimation=true}if(typeof e.getAttribute("eraseBtnWidth")==="string"&&parseInt(e.getAttribute("eraseBtnWidth"))>0){t.eraseBtnWidth=parseInt(e.getAttribute("eraseBtnWidth"))}if(typeof e.getAttribute("customModalText")==="string"){t.customModalText=e.getAttribute("customModalText")}if(typeof e.getAttribute("flipAnimDuration")==="string"&&parseInt(e.getAttribute("flipAnimDuration"))>0){t.flipAnimDuration=parseInt(e.getAttribute("flipAnimDuration"))}return t}},{key:"itemizeIt",value:function o(){var u=this;var p="";try{var e=function e(e){var n=u.targetElements[e];var t=u.makeId(8);n.itemizeId=t;n.classList.add("itemize_parent_".concat(t));for(var i=n.classList.length-1;i>=0;i--){if(n.classList[i].indexOf("itemize_parent")!==-1){n.classList.remove(n.classList[i])}}n.classList.add("itemize_parent_".concat(t));var o=Object.assign({},u.globalOptions);o=u.getOptionsFromAttributes(n,o);n.itemizeOptions=o;var r={attributes:true,childList:true,subtree:true};var a=function a(e,t){var i=true;var o=false;var n=undefined;try{for(var r=e[Symbol.iterator](),a;!(i=(a=r.next()).done);i=true){var s=a.value;if(s.type=="childList"){s.addedNodes.forEach(function(e){var t=true;e.classList.forEach(function(e){if(e.indexOf("itemize_")!==-1){t=false}});if(t){console.log("nouvel element added");console.log(e)}});s.removedNodes.forEach(function(e){var t=true;e.classList.forEach(function(e){if(e.indexOf("itemize_")!==-1){t=false}});if(t){console.log("nouvel element removed");console.log(e)}})}}}catch(l){o=true;n=l}finally{try{if(!i&&r["return"]!=null){r["return"]()}}finally{if(o){throw n}}}};var s=new MutationObserver(a);s.observe(n,r);var l=document.querySelector(u.target+" .itemize_style");if(l){n.querySelector(".itemize_style").remove()}var m=document.createElement("style");m.classList.add("itemize_style");m.type="text/css";var c="";if(n.itemizeOptions.eraseBtn&&!n.itemizeOptions.eraseBtnClass){c+=".itemize_parent_".concat(n.itemizeId," .itemize_btn_close{position:absolute;top:0!important;right:0!important;width:").concat(n.itemizeOptions.eraseBtnWidth,"px!important;height:").concat(n.itemizeOptions.eraseBtnWidth,"px!important;overflow:hidden;cursor:pointer;margin-top:5px;margin-right:5px}.itemize_parent_").concat(n.itemizeId," .itemize_btn_close:hover::after,.itemize_parent_").concat(n.itemizeId," .itemize_btn_close:hover::before{background:").concat(n.itemizeOptions.eraseBtnHoverColor,"}.itemize_parent_").concat(n.itemizeId," .itemize_btn_close::after,.itemize_parent_").concat(n.itemizeId," .itemize_btn_close::before{content:'';position:absolute;height:").concat(n.itemizeOptions.eraseBtnThickness,"px;width:").concat(n.itemizeOptions.eraseBtnWidth,"px;top:50%;left:0;margin-top:").concat(n.itemizeOptions.eraseBtnThickness*.5<1?-1:-n.itemizeOptions.eraseBtnThickness*.5,"px;background:").concat(n.itemizeOptions.eraseBtnColor,";border-radius:100%}.itemize_parent_").concat(n.itemizeId," .itemize_btn_close::before{-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}.itemize_parent_").concat(n.itemizeId," .itemize_btn_close::after{-webkit-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-ms-transform:rotate(-45deg);-o-transform:rotate(-45deg);transform:rotate(-45deg)}")}if(m.styleSheet){m.styleSheet.cssText=c}else{m.appendChild(document.createTextNode(c))}n.appendChild(m);var d=function d(e){var t=n.children[e];if(t.type!=="text/css"&&typeof t.getAttribute("notItemize")!=="string"){if(!t.itemizeId){t.itemizeId=u.makeId(8)}u.items.push(t);t.classList.add("itemize_item_"+t.itemizeId);if(!n.itemizeOptions.eraseBtn){t.onclick=function(){if(n.itemizeOptions.modalConfirm){u.modalConfirm(t.itemizeId)}else{u.erase(t.itemizeId)}}}else{if(!n.itemizeOptions.eraseBtnClass){t.style.position="relative";var i=document.createElement("div");i.classList.add("itemize_btn_"+t.itemizeId);i.classList.add("itemize_btn_close");i.onclick=function(){if(n.itemizeOptions.modalConfirm){console.log(t.itemizeId);u.modalConfirm(t.itemizeId)}else{u.erase(t.itemizeId)}};t.appendChild(i)}else{var o=document.querySelector(".itemize_item_"+t.itemizeId+" ."+n.itemizeOptions.eraseBtnClass);if(!o){p+="Cannot find specified class: "+n.itemizeOptions.eraseBtnClass+"\n"}o.onclick=function(){if(n.itemizeOptions.modalConfirm){u.modalConfirm(t.itemizeId)}else{u.erase(t.itemizeId)}}}}}};for(var f=0;f<n.children.length;f++){d(f)}};for(var t=0;t<this.targetElements.length;t++){e(t)}}catch(i){console.error("- Itemize - ERROR:\n"+p);console.error(i)}}},{key:"modalConfirm",value:function n(e){var t=this;try{var i=null;if(typeof e==="string"){for(var o=0;o<this.items.length;o++){if(this.items[o].itemizeId===e){i=this.items[o]}}if(!i){i=document.querySelector(e);if(!i||!i.itemizeId){throw new Error("Not a valid Itemize element1, cannot create a confirm modal.")}}if(!i){throw new Error("No item found2, cannot create a confirm modal.")}}else{i=elem;if(!i){throw new Error("No item found3, cannot create a confirm modal.")}if(!i.itemizeId){throw new Error("Not a valid Itemize element4, cannot create a confirm modal.")}}var n=document.createElement("div");var r=document.createElement("div");var a=document.createElement("div");var s=document.createElement("div");var l=document.createElement("button");var m=document.createElement("button");var c=document.querySelector("body");var d=c.style.overflow;c.style.overflow="hidden";n.classList.add("itemize_modal_backdrop");r.classList.add("itemize_modal");a.classList.add("itemize_modal_text");l.classList.add("itemize_modal_btnConfirm");m.classList.add("itemize_modal_btnCancel");a.textContent=i.parentNode.itemizeOptions.customModalText;l.innerHTML="Yes";m.innerHTML="Cancel";s.appendChild(m);s.appendChild(l);r.appendChild(a);r.appendChild(s);var f=function f(e,t,i){t.animate([{opacity:1},{opacity:0}],{duration:300,easing:"ease-in-out",fill:"both"});i.animate([{opacity:1,transform:"translateY(-50%) translateX(-50%)"},{opacity:0,transform:"translateY(0%) translateX(-50%)"}],{duration:300,easing:"cubic-bezier(.75,-0.5,0,1.75)",fill:"both"});setTimeout(function(){e.removeChild(t);e.removeChild(i);e.style.overflow=d},300)};n.onclick=function(){f(c,n,r)};m.onclick=function(){f(c,n,r)};l.onclick=function(){f(c,n,r);t.erase(e)};Object.assign(r.style,{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"25px",background:"#FFFFFF",width:"90vw",maxWidth:"500px",borderRadius:"4px",boxSizing:"border-box",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center",fontFamily:"helvetica",zIndex:1e6});Object.assign(a.style,{marginBottom:"25px"});Object.assign(s.style,{width:"100%",display:"flex"});Object.assign(m.style,{background:"#6C757D",border:"none",padding:"10px 0 10px 0",borderTopLeftRadius:"4px",borderBottomLeftRadius:"4px",flex:"1 0 auto",cursor:"pointer",color:"#FFFFFF"});Object.assign(l.style,{background:"#F94336",border:"none",padding:"10px 0 10px 0",borderTopRightRadius:"4px",borderBottomRightRadius:"4px",flex:"1 0 auto",cursor:"pointer",color:"#FFFFFF"});Object.assign(n.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0, 0, 0,0.5)",zIndex:1e5});c.prepend(r);c.prepend(n);n.animate([{opacity:0},{opacity:1}],{duration:300,easing:"ease-in-out",fill:"both"});r.animate([{opacity:0,transform:"translateY(-100%) translateX(-50%)"},{opacity:1,transform:"translateY(-50%) translateX(-50%)"}],{duration:400,easing:"cubic-bezier(.75,-0.5,0,1.75)",fill:"both"})}catch(u){console.error("- Itemize - ERROR:\n"+u)}}},{key:"showAlert",value:function r(e,t){var i=this;if(t.parentNode.itemizeOptions.showAlert){if(e==="removed"){this.alertNb++;var o=document.createElement("div");o.alertNb=this.alertNb;var n=document.createElement("div");var r=document.createElement("div");o.classList.add("itemize_removed_alert");r.classList.add("itemize_removed_alert_text");r.textContent="Item  successfully removed";Object.assign(r.style,{boxSizing:"border-box",width:"100%",height:"100%",textAlign:"center",padding:"10px 15px 10px 15px"});Object.assign(n.style,{background:"#DEADAD",width:"100%",height:"5px",transition:"width 4s"});Object.assign(o.style,{boxSizing:"border-box",position:"fixed",display:"flex",flexDirection:"column",justifyContent:"center",top:"100%",left:"50%",transform:"translate(-50%, -".concat(this.alertNb*100,"%)"),fontFamily:"helvetica",background:"#BD5B5B",borderRadius:"2px",color:"#FFFFFF",zIndex:1e5});document.querySelector("body").appendChild(o);o.appendChild(n);o.appendChild(r);n.animate([{width:"100%"},{width:"0%"}],{duration:4e3,easing:"linear",fill:"both"});setTimeout(function(){var e=document.querySelectorAll(".itemize_removed_alert");for(var t=0;t<e.length;t++){e[t].animate([{transform:"translate(-50%, -".concat(e[t].alertNb*100,"%)")},{transform:"translate(-50%, -".concat(e[t].alertNb*100-100,"%)")}],{duration:300,easing:"ease-in-out",fill:"both"});e[t].alertNb--}i.alertNb--;document.querySelector("body").removeChild(o)},4e3)}}}},{key:"erase",value:function a(e){var i=this;try{var o=null;if(typeof e==="string"){for(var t=0;t<this.items.length;t++){if(this.items[t].itemizeId===e){o=this.items[t];o.arrayPosition=t}}if(!o){o=document.querySelector(e);if(!o||!o.itemizeId){throw new Error("Not a valid Itemize element")}for(var n=0;n<this.items.length;n++){if(this.items[n].itemizeId===o.itemizeId){o.arrayPosition=n}}}if(!o){throw new Error("No item found to erase")}}else{o=e;if(!o){throw new Error("No item found to erase")}if(!o.itemizeId){throw new Error("Not a valid Itemize element")}for(var r=0;r<this.items.length;r++){if(o.itemizeId===this.items[r].itemizeId){o.arrayPosition=r}}}if(o.arrayPosition||o.arrayPosition===0){if(!o.removeStatus||o.removeStatus!=="pending"){if(this.globalOptions.beforeErase){o.removeStatus="pending";var a=this.globalOptions.beforeErase(o);if(typeof a.then==="function"){a.then(function(e){console.log(e);if(o.parentNode.itemizeOptions.flipAnimation){var t=o.querySelector(".itemize_btn_close");if(t){t.onclick=null}else{t=o.querySelector("."+i.globalOptions.eraseBtnClass);if(t){t.onclick=null}}i.showAlert("removed",o);i.flipRead(i.items);i.flipRemove(o);i.items.splice(o.arrayPosition,1);i.flipPlay(i.items)}else{i.showAlert("removed",o);o.removeStatus=null;o.parentNode.removeChild(o);i.items.splice(o.arrayPosition,1)}})["catch"](function(e){console.log(e);o.removeStatus=null})}else if(a){if(o.parentNode.itemizeOptions.flipAnimation){var s=o.querySelector(".itemize_btn_close");if(s){s.onclick=null}else{s=o.querySelector("."+this.globalOptions.eraseBtnClass);if(s){s.onclick=null}}this.showAlert("removed",o);this.flipRead(this.items);this.flipRemove(o);this.items.splice(o.arrayPosition,1);this.flipPlay(this.items)}else{this.showAlert("removed",o);o.removeStatus=null;o.parentNode.removeChild(o);this.items.splice(o.arrayPosition,1)}}}else{if(o.parentNode.itemizeOptions.flipAnimation){var l=o.querySelector(".itemize_btn_close");if(l){l.onclick=null}else{l=o.querySelector("."+this.globalOptions.eraseBtnClass);if(l){l.onclick=null}}this.showAlert("removed",o);this.flipRead(this.items);this.flipRemove(o);this.items.splice(o.arrayPosition,1);this.flipPlay(this.items)}else{this.showAlert("removed",o);o.removeStatus=null;o.parentNode.removeChild(o);this.items.splice(o.arrayPosition,1)}}}}else{throw new Error("this element has an invalid itemizeId")}}catch(m){console.error("- Itemize - ERROR:\n"+m)}}},{key:"flipRemove",value:function s(e){e.parentNode.appendChild(e);var t=e.getBoundingClientRect();var i=this.elPos[e.itemizeId];var o=i.x-t.x;var n=i.y-t.y;e.animate([{transform:"translate(".concat(o,"px, ").concat(n,"px)"),opacity:1},{transform:"translate(".concat(o+50,"px, ").concat(n,"px)"),opacity:0}],{duration:e.parentNode.itemizeOptions.flipAnimDuration,easing:"ease-in-out",fill:"both"});setTimeout(function(){e.removeStatus=null;e.parentNode.removeChild(e)},e.parentNode.itemizeOptions.flipAnimDuration)}},{key:"flipRead",value:function l(e){this.elPos={};for(var t=0;t<e.length;t++){this.elPos[e[t].itemizeId]=e[t].getBoundingClientRect()}}},{key:"flipPlay",value:function m(e){for(var t=0;t<e.length;t++){var i=e[t].getBoundingClientRect();var o=this.elPos[e[t].itemizeId];var n=o.x-i.x;var r=o.y-i.y;var a=o.width/i.width;var s=o.height/i.height;e[t].animate([{transform:"translate(".concat(n,"px, ").concat(r,"px) scale(").concat(a,", ").concat(s,")")},{transform:"none"}],{duration:e[t].parentNode.itemizeOptions.flipAnimDuration,easing:"ease-in-out",fill:"both"})}}},{key:"mergeOptions",value:function c(e){try{var t={eraseBtn:true,eraseBtnWidth:20,eraseBtnThickness:2,eraseBtnColor:"#525252",eraseBtnHoverColor:"#000000",eraseBtnClass:null,showAlert:true,modalConfirm:false,customModalText:"Are you sure to remove this item?",flipAnimation:true,flipAnimDuration:500,beforeErase:null};for(var i in e){if(e.hasOwnProperty(i))t[i]=e[i]}return t}catch(o){console.error(o)}}},{key:"optionsTypeCheck",value:function d(e){var t="";if(typeof e.eraseBtn!=="boolean"){t+="option 'button' must be a Boolean\n"}if(typeof e.modalConfirm!=="boolean"){t+="option 'modalConfirm' must be a Boolean\n"}if(typeof e.showAlert!=="boolean"){t+="option 'showAlert' must be a Boolean\n"}if(typeof e.eraseBtnWidth!=="number"){t+="option 'eraseBtnWidth' must be a Number\n"}if(typeof e.eraseBtnThickness!=="number"){t+="option 'eraseBtnThickness' must be a Number\n"}if(e.eraseBtnClass&&typeof e.eraseBtnClass!=="string"){t+="option 'buttonClass' must be a String\n"}if(typeof e.customModalText!=="string"){t+="option 'customModalText' must be a String\n"}if(typeof e.flipAnimation!=="boolean"){t+="option 'flipAnimation' must be a Boolean\n"}if(typeof e.flipAnimDuration!=="number"){t+="option 'flipAnimDuration' must be a Number\n"}if(e.beforeErase&&typeof e.beforeErase!=="function"){t+="option 'beforeErase' must be a Function\n"}if(t===""){return"valid"}else{return t}}},{key:"makeId",value:function f(e){var t="";var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";var o=i.length;for(var n=0;n<e;n++){t+=i.charAt(Math.floor(Math.random()*o))}return t}}]);return i}();